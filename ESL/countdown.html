<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Countdown Timer</title>
<style>
  :root{
    --bg:#0f1226;
    --panel:#171a36;
    --text:#e9ecff;
    --accent:#6ea8fe;
    --good:#2bd47c;
    --warn:#ffcc00;
    --bad:#ff3b3b;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background: radial-gradient(1200px 800px at 50% -10%, #1a1e3e, var(--bg));
    color:var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    display:grid;
    place-items:center;
  }
  .wrap{
    width:min(720px, 92vw);
    background:linear-gradient(180deg, #1b1f44, var(--panel));
    border:1px solid rgba(255,255,255,.08);
    border-radius:18px;
    padding:24px;
    box-shadow: 0 40px 100px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
  }
  h1{
    margin:0 0 14px;
    font-weight:700;
    letter-spacing:.3px;
    font-size: clamp(16px, 2.2vw, 18px);
    color:#cfd6ff;
    opacity:.9;
  }

  .controls{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:center;
    margin-bottom:18px;
  }
  .field{
    position:relative;
    flex:1 1 220px;
    min-width:210px;
  }
  .field input{
    width:100%;
    padding:14px 14px 14px 44px;
    border-radius:12px;
    border:1px solid rgba(255,255,255,.12);
    background:#111430;
    color:var(--text);
    font-size:16px;
    outline:none;
    transition:border-color .2s;
  }
  .field input:focus{border-color:var(--accent)}
  .field label{
    position:absolute; left:12px; top:50%; transform:translateY(-50%);
    font-size:12px; opacity:.65; letter-spacing:.3px;
  }
  .btn{
    appearance:none; border:0; cursor:pointer;
    padding:12px 16px; border-radius:12px;
    background:#0f1333; color:#cfd6ff;
    border:1px solid rgba(255,255,255,.12);
    font-weight:600; letter-spacing:.3px;
    transition:transform .05s ease, background .2s ease, border-color .2s ease, opacity .2s ease;
  }
  .btn:active{transform:translateY(1px)}
  .btn.primary{background:linear-gradient(180deg, #274cff, #1d34ff); color:white; border-color:transparent}
  .btn.secondary{background:#12163a}
  .btn.ghost{background:transparent}
  .btn[disabled]{opacity:.5; cursor:not-allowed}

  .display{
    margin-top:8px;
    user-select:none;
    font-variant-numeric: tabular-nums lining-nums;
    display:flex; align-items:baseline; justify-content:center;
    gap:10px;
  }
  .time{
    font-size: clamp(54px, 12vw, 132px);
    line-height:1;
    font-weight:800;
    letter-spacing:2px;
    text-shadow: 0 8px 30px rgba(0,0,0,.55);
  }
  .ms{
    font-size: clamp(22px, 4.5vw, 40px);
    opacity:.9;
  }
  .status{
    text-align:center; margin-top:6px; opacity:.8; font-size:13px;
  }
  .bar{
    width:100%; height:10px; border-radius:999px; background:#0e1230; overflow:hidden;
    margin-top:18px; border:1px solid rgba(255,255,255,.06);
  }
  .bar > i{
    display:block; height:100%; width:0%;
    background:linear-gradient(90deg, var(--good), var(--accent));
    transition: width .08s linear, background .3s ease;
  }

  /* Dramatic endgame effects */
  .warning .time{ color: var(--warn); }
  .warning .bar > i{ background:linear-gradient(90deg, var(--warn), #ff9900); }
  .warning .display{ animation: pulse 1s ease-in-out infinite; }

  .critical .time{ color: var(--bad); text-shadow: 0 0 18px rgba(255,59,59,.55), 0 0 50px rgba(255,59,59,.35); }
  .critical .bar > i{ background:linear-gradient(90deg, #ff6b6b, var(--bad)); }
  .critical .display{ animation: pulseFast .45s ease-in-out infinite, shake .6s cubic-bezier(.36,.07,.19,.97) infinite; }

  .done .display{ animation: burst 800ms ease-out 1; }
  .done .time{ color:#ffffff; }
  .done .bar > i{ background:linear-gradient(90deg, #ffffff, #dddddd); }

  @keyframes pulse{
    0%,100%{ transform:scale(1); filter:none }
    50%{ transform:scale(1.03); filter:brightness(1.08) }
  }
  @keyframes pulseFast{
    0%,100%{ transform:scale(1); filter:none }
    50%{ transform:scale(1.06); filter:brightness(1.2) }
  }
  @keyframes shake{
    10%, 90% { transform: translateX(-1px); }
    20%, 80% { transform: translateX(2px); }
    30%, 50%, 70% { transform: translateX(-4px); }
    40%, 60% { transform: translateX(4px); }
  }
  @keyframes burst{
    0%{ filter:brightness(1); transform:scale(1) }
    25%{ filter:brightness(1.8); transform:scale(1.04) }
    100%{ filter:brightness(1); transform:scale(1) }
  }

  .help{
    margin-top:12px; font-size:12px; opacity:.7; text-align:center;
  }
  .chips{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:10px;}
  .chip{
    font-size:12px; padding:8px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.14);
    background:#0f1332; cursor:pointer; user-select:none;
  }
  .chip:active{ transform:translateY(1px) }
</style>
</head>
<body>
  <div class="wrap" id="app">
    <h1>Countdown Timer</h1>

    <div class="controls">
      <div class="field">
        <label for="timeInput">Time</label>
        <input id="timeInput" type="text" placeholder="e.g. 2:00, 90, 1:05.500" autocomplete="off" />
      </div>
      <button id="startBtn" class="btn primary">Start</button>
      <button id="pauseBtn" class="btn secondary" disabled>Pause</button>
      <button id="resetBtn" class="btn ghost" disabled>Reset</button>
    </div>

    <div class="chips">
      <span class="chip" data-preset="30">:30</span>
      <span class="chip" data-preset="60">1:00</span>
      <span class="chip" data-preset="90">1:30</span>
      <span class="chip" data-preset="180">3:00</span>
    </div>

    <div class="display">
      <div class="time" id="timeMain">00:00</div>
      <div class="ms" id="timeMs">.000</div>
    </div>
    <div class="status" id="status">Enter a time and press Start.</div>
    <div class="bar" aria-hidden="true"><i id="progress"></i></div>

    <div class="help">Formats: <code>SS</code> &middot; <code>SS.mmm</code> &middot; <code>MM:SS</code> &middot; <code>MM:SS.mmm</code>. Press <kbd>Enter</kbd> to start / <kbd>Space</kbd> to pause.</div>
  </div>

<script>
(function(){
  const el = (id)=>document.getElementById(id);
  const app = el('app');
  const timeInput = el('timeInput');
  const startBtn = el('startBtn');
  const pauseBtn = el('pauseBtn');
  const resetBtn = el('resetBtn');
  const timeMain = el('timeMain');
  const timeMs = el('timeMs');
  const status = el('status');
  const progress = el('progress');

  // thresholds (customize)
  const WARN_MS = 10_000;     // last 10s -> yellow pulse
  const CRITICAL_MS = 3_000;  // last 3s  -> red rapid pulse + shake

  let totalMs = 0;
  let remainingMs = 0;
  let endStamp = null;        // performance.now() when it ends
  let rafId = null;
  let running = false;
  let paused = false;

  function parseTime(str){
    // accepts "MM:SS.mmm", "MM:SS", "SS.mmm", "SS"
    str = (str || "").trim();
    if(!str) return NaN;

    if(str.includes(':')){
      const [mm, restRaw] = str.split(':');
      const rest = restRaw ?? "0";
      const [ss, ms='0'] = rest.split('.');
      const m = Number(mm);
      const s = Number(ss);
      const millis = Number((ms + "000").slice(0,3)); // pad/truncate to 3 digits
      if([m,s,millis].some(n=>Number.isNaN(n) || n<0)) return NaN;
      return (m*60 + s)*1000 + millis;
    }else{
      const [ss, ms='0'] = str.split('.');
      const s = Number(ss);
      const millis = Number((ms + "000").slice(0,3));
      if([s,millis].some(n=>Number.isNaN(n) || n<0)) return NaN;
      return s*1000 + millis;
    }
  }

  function format(ms){
    ms = Math.max(0, Math.floor(ms));
    const m = Math.floor(ms/60000);
    const s = Math.floor((ms%60000)/1000);
    const mm = String(m).padStart(2,'0');
    const ss = String(s).padStart(2,'0');
    const mmm = String(ms%1000).padStart(3,'0');
    return { main: `${mm}:${ss}`, ms: `.${mmm}` };
  }

  function setStatus(txt){ status.textContent = txt; }

  function applyStages(msLeft){
    app.classList.remove('warning', 'critical', 'done');
    if(msLeft <= 0){ app.classList.add('done'); return; }
    if(msLeft <= CRITICAL_MS){ app.classList.add('critical'); return; }
    if(msLeft <= WARN_MS){ app.classList.add('warning'); }
  }

  function updateProgress(){
    const pct = totalMs ? (1 - remainingMs/totalMs) * 100 : 0;
    progress.style.width = `${Math.min(100, Math.max(0, pct))}%`;
  }

  function draw(){
    const now = performance.now();
    remainingMs = Math.max(0, Math.round(endStamp - now));
    const {main, ms} = format(remainingMs);
    timeMain.textContent = main;
    timeMs.textContent = ms;
    applyStages(remainingMs);
    updateProgress();

    if(remainingMs <= 0){
      running = false; paused = false;
      startBtn.disabled = false; pauseBtn.disabled = true; resetBtn.disabled = false;
      setStatus('Finished!');
      cancelAnimationFrame(rafId); rafId = null;
      return;
    }
    rafId = requestAnimationFrame(draw);
  }

  function startFromInput(){
    const parsed = parseTime(timeInput.value);
    if(Number.isNaN(parsed) || parsed <= 0){
      setStatus('Please enter a valid time (e.g., 2:00, 90, 1:05.500).');
      return;
    }
    totalMs = parsed;
    remainingMs = totalMs;
    endStamp = performance.now() + remainingMs;
    running = true; paused = false;
    startBtn.disabled = true; pauseBtn.disabled = false; resetBtn.disabled = false;
    setStatus('Counting down…');
    app.classList.remove('done'); // clear previous finish effect
    if(rafId) cancelAnimationFrame(rafId);
    rafId = requestAnimationFrame(draw);
  }

  function pauseResume(){
    if(!running && !paused) return;
    if(!paused){
      // pause
      paused = true;
      running = false;
      pauseBtn.textContent = 'Resume';
      startBtn.disabled = true;
      if(rafId) cancelAnimationFrame(rafId);
      rafId = null;
      // compute fresh remaining
      remainingMs = Math.max(0, Math.round(endStamp - performance.now()));
      setStatus('Paused');
    }else{
      // resume
      paused = false;
      running = true;
      pauseBtn.textContent = 'Pause';
      endStamp = performance.now() + remainingMs;
      setStatus('Counting down…');
      rafId = requestAnimationFrame(draw);
    }
  }

  function reset(){
    running = false; paused = false;
    startBtn.disabled = false; pauseBtn.disabled = true; resetBtn.disabled = true;
    pauseBtn.textContent = 'Pause';
    if(rafId) cancelAnimationFrame(rafId);
    rafId = null;
    totalMs = 0; remainingMs = 0;
    timeMain.textContent = '00:00';
    timeMs.textContent = '.000';
    progress.style.width = '0%';
    app.classList.remove('warning','critical','done');
    setStatus('Enter a time and press Start.');
  }

  // Presets
  document.querySelectorAll('.chip').forEach(chip=>{
    chip.addEventListener('click', ()=>{
      const ss = Number(chip.dataset.preset || '0');
      timeInput.value = ss >= 60
        ? `${Math.floor(ss/60)}:${String(ss%60).padStart(2,'0')}`
        : String(ss);
    });
  });

  // Buttons & keys
  startBtn.addEventListener('click', startFromInput);
  pauseBtn.addEventListener('click', pauseResume);
  resetBtn.addEventListener('click', reset);

  timeInput.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){ e.preventDefault(); startFromInput(); }
    if(e.key === ' '){
      // space toggles pause if running, else start
      e.preventDefault();
      if(startBtn.disabled) pauseResume();
      else startFromInput();
    }
  });

  // Autofocus convenience
  timeInput.focus();

})();
</script>
</body>
</html>